name: Release

on:
  release:
    types:
      - published
env:
  # Official NuGet Feed settings
  NUGET_FEED: https://api.nuget.org/v3/index.json
  NUGET_KEY: ${{ secrets.NUGET_KEY }}

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  deploy:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2
        - name: Setup .NET Core
          uses: actions/setup-dotnet@v1
          with:
            dotnet-version: 5.0.x
        - name: Create Release NuGet package
          run: |
            arrTag=(${GITHUB_REF//\// })
            VERSION="${arrTag[2]}"
            echo Version: $VERSION
            VERSION="${VERSION//v}"
            dotnet pack -v normal -c Release --include-symbols --include-source -p:PackageVersion=$VERSION -o nupkg

